<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Get weights for a neural network — neuralweights • NeuralNetTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Get weights for a neural network — neuralweights"><meta property="og:description" content="Get weights for a neural network in an organized list by extracting values from a neural network object.  This function is generally not called by itself."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NeuralNetTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Overview.html">Overview</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fawda123/NeuralNetTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get weights for a neural network</h1>
    <small class="dont-index">Source: <a href="https://github.com/fawda123/NeuralNetTools/blob/HEAD/R/NeuralNetTools_utils.R" class="external-link"><code>R/NeuralNetTools_utils.R</code></a></small>
    <div class="hidden name"><code>neuralweights.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Get weights for a neural network in an organized list by extracting values from a neural network object.  This function is generally not called by itself.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">neuralweights</span><span class="op">(</span><span class="va">mod_in</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for numeric</span>
<span class="fu">neuralweights</span><span class="op">(</span><span class="va">mod_in</span>, rel_rsc <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">struct</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for nnet</span>
<span class="fu">neuralweights</span><span class="op">(</span><span class="va">mod_in</span>, rel_rsc <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for mlp</span>
<span class="fu">neuralweights</span><span class="op">(</span><span class="va">mod_in</span>, rel_rsc <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for nn</span>
<span class="fu">neuralweights</span><span class="op">(</span><span class="va">mod_in</span>, rel_rsc <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mod_in</dt>
<dd><p>input object for which an organized model list is desired.  The input can be an object of class <code>numeric</code>, <code>nnet</code>, <code>mlp</code>, or <code>nn</code></p></dd>
<dt>...</dt>
<dd><p>arguments passed to other methods</p></dd>
<dt>rel_rsc</dt>
<dd><p>numeric indicating the scaling range for the width of connection weights in a neural interpretation diagram. Default is <code>NULL</code> for no rescaling.</p></dd>
<dt>struct</dt>
<dd><p>numeric vector equal in length to the number of layers in the network.  Each number indicates the number of nodes in each layer starting with the input and ending with the output.  An arbitrary number of hidden layers can be included.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a two-element list with the first element being a vector indicating the number of nodes in each layer of the neural network and the second element being a named list of weight values for the input model.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Each element of the returned list is named using the construct 'layer node', e.g. 'out 1' is the first node of the output layer.  Hidden layers are named using three values for instances with more than one hidden layer, e.g., 'hidden 1 1' is the first node in the first hidden layer, 'hidden 1 2' is the second node in the first hidden layer, 'hidden 2 1' is the first node in the second hidden layer, etc.  The values in each element of the list represent the weights entering the specific node from the preceding layer in sequential order, starting with the bias layer if applicable.  For example, the elements in a list item for 'hidden 1 1' of a neural network with a 3 5 1 structure (3 inputs, 5 hidden nodes, 1 output) would have four values indicating the weights in sequence from the bias layer, first input layer, second input layer, and third input layer going to the first hidden node.</p>
<p>The function will remove direct weight connections between input and output layers if the neural network was created with a skip-layer using <code>skip = TRUE</code> with the <code><a href="https://rdrr.io/pkg/nnet/man/nnet.html" class="external-link">nnet</a></code>  or <code><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></code> functions.  This may produce misleading results when evaluating variable performance with the <code><a href="garson.html">garson</a></code> function.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">neuraldat</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## using numeric input</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">wts_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13.12</span>, <span class="fl">1.49</span>, <span class="fl">0.16</span>, <span class="op">-</span><span class="fl">0.11</span>, <span class="op">-</span><span class="fl">0.19</span>, <span class="op">-</span><span class="fl">0.16</span>, <span class="fl">0.56</span>, <span class="op">-</span><span class="fl">0.52</span>, <span class="fl">0.81</span><span class="op">)</span></span>
<span class="r-in"><span class="va">struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span> <span class="co">#two inputs, two hidden, one output </span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">neuralweights</span><span class="op">(</span><span class="va">wts_in</span>, struct <span class="op">=</span> <span class="va">struct</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $struct</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 2 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wts$`hidden 1 1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13.12  1.49  0.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wts$`hidden 1 2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.11 -0.19 -0.16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wts$`out 1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.56 -0.52  0.81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## using nnet</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">nnet</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/nnet.html" class="external-link">nnet</a></span><span class="op">(</span><span class="va">Y1</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, data <span class="op">=</span> <span class="va">neuraldat</span>, size <span class="op">=</span> <span class="fl">5</span>, linout <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 1768.536857 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 1.856275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 0.062478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 0.014742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 0.006542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 0.001109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 0.000999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 0.000402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 0.000073 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> converged</span>
<span class="r-in"> </span>
<span class="r-in"><span class="fu">neuralweights</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $struct</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3 5 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wts$`hidden 1 1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.79244745 -0.08878205 -0.34869446  0.99886444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wts$`hidden 1 2`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1.63768901 -0.71701897  0.95502425 -0.06234557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wts$`hidden 1 3`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1.4696987 -0.7838884 -0.6890212  0.7290061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wts$`hidden 1 4`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  1.0789572 -0.1274677 -0.1827771  0.1007104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wts$`hidden 1 5`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.4746862 -0.1537787 -0.2235660  0.1210513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wts$`out 1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.094561e+00 -5.262218e-04  6.680189e-05 -2.581654e-03  1.809908e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6]  1.174171e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co">## using RSNNS, no bias layers</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cbergmeir/RSNNS" class="external-link">RSNNS</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">neuraldat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'X1'</span>, <span class="st">'X2'</span>, <span class="st">'X3'</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">neuraldat</span><span class="op">[</span>, <span class="st">'Y1'</span><span class="op">]</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSNNS/man/mlp.html" class="external-link">mlp</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, size <span class="op">=</span> <span class="fl">5</span>, linOut <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">neuralweights</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># pruned model using code from RSSNS pruning demo</span></span>
<span class="r-in"><span class="va">pruneFuncParams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>max_pr_error_increase <span class="op">=</span> <span class="fl">10.0</span>, pr_accepted_error <span class="op">=</span> <span class="fl">1.0</span>, </span>
<span class="r-in"> no_of_pr_retrain_cycles <span class="op">=</span> <span class="fl">1000</span>, min_error_to_stop <span class="op">=</span> <span class="fl">0.01</span>, init_matrix_value <span class="op">=</span> <span class="fl">1e-6</span>, </span>
<span class="r-in"> input_pruning <span class="op">=</span> <span class="cn">TRUE</span>, hidden_pruning <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSNNS/man/mlp.html" class="external-link">mlp</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, size <span class="op">=</span> <span class="fl">5</span>, pruneFunc <span class="op">=</span> <span class="st">"OptimalBrainSurgeon"</span>, </span>
<span class="r-in"> pruneFuncParams <span class="op">=</span> <span class="va">pruneFuncParams</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">neuralweights</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## using neuralnet</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bips-hb/neuralnet" class="external-link">neuralnet</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html" class="external-link">neuralnet</a></span><span class="op">(</span><span class="va">Y1</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, data <span class="op">=</span> <span class="va">neuraldat</span>, hidden <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">neuralweights</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marcus W. Beck.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>


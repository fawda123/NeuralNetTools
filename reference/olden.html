<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Variable importance using connection weights — olden • NeuralNetTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Variable importance using connection weights — olden"><meta property="og:description" content="Relative importance of input variables in neural networks as the sum of the product of raw input-hidden, hidden-output connection weights, proposed by Olden et al. 2004."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NeuralNetTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Overview.html">Overview</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/fawda123/NeuralNetTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Variable importance using connection weights</h1>
    <small class="dont-index">Source: <a href="https://github.com/fawda123/NeuralNetTools/blob/HEAD/R/NeuralNetTools_old.R" class="external-link"><code>R/NeuralNetTools_old.R</code></a></small>
    <div class="hidden name"><code>olden.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Relative importance of input variables in neural networks as the sum of the product of raw input-hidden, hidden-output connection weights, proposed by Olden et al. 2004.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">olden</span><span class="op">(</span><span class="va">mod_in</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">olden</span><span class="op">(</span>
  <span class="va">mod_in</span>,
  <span class="va">x_names</span>,
  <span class="va">y_names</span>,
  out_var <span class="op">=</span> <span class="cn">NULL</span>,
  bar_plot <span class="op">=</span> <span class="cn">TRUE</span>,
  x_lab <span class="op">=</span> <span class="cn">NULL</span>,
  y_lab <span class="op">=</span> <span class="cn">NULL</span>,
  skip_wts <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for numeric</span>
<span class="fu">olden</span><span class="op">(</span><span class="va">mod_in</span>, <span class="va">struct</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for nnet</span>
<span class="fu">olden</span><span class="op">(</span><span class="va">mod_in</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for mlp</span>
<span class="fu">olden</span><span class="op">(</span><span class="va">mod_in</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for nn</span>
<span class="fu">olden</span><span class="op">(</span><span class="va">mod_in</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for train</span>
<span class="fu">olden</span><span class="op">(</span><span class="va">mod_in</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mod_in</dt>
<dd><p>input model object or a list of model weights as returned from <code><a href="neuralweights.html">neuralweights</a></code> if using the default method</p></dd>
<dt>...</dt>
<dd><p>arguments passed to or from other methods</p></dd>
<dt>x_names</dt>
<dd><p>chr string of input variable names, obtained from the model object</p></dd>
<dt>y_names</dt>
<dd><p>chr string of response variable names, obtained from the model object</p></dd>
<dt>out_var</dt>
<dd><p>chr string indicating the response variable in the neural network object to be evaluated.  Only one input is allowed for models with more than one response.  Names must be of the form <code>'Y1'</code>, <code>'Y2'</code>, etc. if using numeric values as weight inputs for <code>mod_in</code>.</p></dd>
<dt>bar_plot</dt>
<dd><p>logical indicating if a <code>ggplot</code> object is returned (default <code>T</code>), otherwise numeric values are returned</p></dd>
<dt>x_lab</dt>
<dd><p>chr string of alternative names to be used for explanatory variables in the figure, default is taken from <code>mod_in</code></p></dd>
<dt>y_lab</dt>
<dd><p>chr string of alternative names to be used for response variable in the figure, default is taken from <code>out_var</code></p></dd>
<dt>skip_wts</dt>
<dd><p>vector from <code><a href="neuralskips.html">neuralskips</a></code> for <code><a href="https://rdrr.io/pkg/nnet/man/nnet.html" class="external-link">nnet</a></code> models with skip-layer connections</p></dd>
<dt>struct</dt>
<dd><p>numeric vector equal in length to the number of layers in the network.  Each number indicates the number of nodes in each layer starting with the input and ending with the output.  An arbitrary number of hidden layers can be included.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></code> object for plotting if <code>bar_plot = FALSE</code>, otherwise a <code>data.frame</code> of relative importance values for each input variable.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This method is similar to Garson's algorithm (Garson 1991, modified by Goh 1995) in that the connection weights between layers of a neural network form the basis for determining variable importance.  However, Olden et al. 2004 describe a connection weights algorithm that consistently out-performed Garson's algorithm in representing the true variable importance in simulated datasets.  This `Olden' method calculates variable importance as the product of the raw input-hidden and hidden-output connection weights between each input and output neuron and sums the product across all hidden neurons.  An advantage of this approach is the relative contributions of each connection weight are maintained in terms of both magnitude and sign as compared to Garson's algorithm which only considers the absolute magnitude. For example, connection weights that change sign (e.g., positive to negative) between the input-hidden to hidden-output layers would have a cancelling effect whereas Garson's algorithm may provide misleading results based on the absolute magnitude.  An additional advantage is that Olden's algorithm is capable of evaluating neural networks with multiple hidden layers wheras Garson's was developed for networks with a single hidden layer.</p>
<p>The importance values assigned to each variable are in units that are based directly on the summed product of the connection weights.  The actual values should only be interpreted based on relative sign and magnitude between explanatory variables.  Comparisons between different models should not be made.</p>
<p>The Olden function also works with networks that have skip layers by adding the input-output connection weights to the final summed product of all input-hidden and hidden-output connections.  This was not described in the original method so interpret with caution.</p>
<p>By default, the results are shown only for the first response variable for networks with multiple output nodes.  The plotted response variable can be changed with <code>out_var</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Beck, M.W. 2018. NeuralNetTools: Visualization and Analysis Tools for Neural Networks. Journal of Statistical Software. 85(11):1-20.</p>
<p>Garson, G.D. 1991. Interpreting neural network connection weights. Artificial Intelligence Expert. 6(4):46-51.</p>
<p>Goh, A.T.C. 1995. Back-propagation neural networks for modeling complex systems. Artificial Intelligence in Engineering. 9(3):143-151.</p>
<p>Olden, J.D., Jackson, D.A. 2002. Illuminating the 'black-box': a randomization approach for understanding variable contributions in artificial neural networks. Ecological Modelling. 154:135-150.</p>
<p>Olden, J.D., Joy, M.K., Death, R.G. 2004. An accurate comparison of methods for quantifying variable importance in artificial neural networks using simulated data. Ecological Modelling. 178:389-397.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co">## using numeric input</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">wts_in</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">13.12</span>, <span class="fl">1.49</span>, <span class="fl">0.16</span>, <span class="op">-</span><span class="fl">0.11</span>, <span class="op">-</span><span class="fl">0.19</span>, <span class="op">-</span><span class="fl">0.16</span>, <span class="fl">0.56</span>, <span class="op">-</span><span class="fl">0.52</span>, <span class="fl">0.81</span><span class="op">)</span></span>
<span class="r-in"><span class="va">struct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span> <span class="co">#two inputs, two hidden, one output </span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">olden</span><span class="op">(</span><span class="va">wts_in</span>, <span class="va">struct</span><span class="op">)</span></span>
<span class="r-plt img"><img src="olden-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## using nnet</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">nnet</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">neuraldat</span><span class="op">)</span> </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/nnet.html" class="external-link">nnet</a></span><span class="op">(</span><span class="va">Y1</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, data <span class="op">=</span> <span class="va">neuraldat</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # weights:  26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> initial  value 259.012592 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  10 value 0.986480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  20 value 0.225311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  30 value 0.139585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  40 value 0.098961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  50 value 0.038200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  60 value 0.022839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  70 value 0.013774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  80 value 0.008530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter  90 value 0.005172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> iter 100 value 0.003044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> final  value 0.003044 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> stopped after 100 iterations</span>
<span class="r-in"> </span>
<span class="r-in"><span class="fu">olden</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>  </span>
<span class="r-plt img"><img src="olden-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co">## View the difference for a model w/ skip layers</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/nnet.html" class="external-link">nnet</a></span><span class="op">(</span><span class="va">Y1</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, data <span class="op">=</span> <span class="va">neuraldat</span>, size <span class="op">=</span> <span class="fl">5</span>, skip <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">olden</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## using RSNNS, no bias layers</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cbergmeir/RSNNS" class="external-link">RSNNS</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">neuraldat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'X1'</span>, <span class="st">'X2'</span>, <span class="st">'X3'</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">neuraldat</span><span class="op">[</span>, <span class="st">'Y1'</span><span class="op">]</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSNNS/man/mlp.html" class="external-link">mlp</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">olden</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## using neuralnet</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bips-hb/neuralnet" class="external-link">neuralnet</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html" class="external-link">neuralnet</a></span><span class="op">(</span><span class="va">Y1</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, data <span class="op">=</span> <span class="va">neuraldat</span>, hidden <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">olden</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## using caret</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSNNS/man/train.html" class="external-link">train</a></span><span class="op">(</span><span class="va">Y1</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, method <span class="op">=</span> <span class="st">'nnet'</span>, data <span class="op">=</span> <span class="va">neuraldat</span>, linout <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">olden</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## multiple hidden layers</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">neuraldat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'X1'</span>, <span class="st">'X2'</span>, <span class="st">'X3'</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">neuraldat</span><span class="op">[</span>, <span class="st">'Y1'</span><span class="op">]</span></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSNNS/man/mlp.html" class="external-link">mlp</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">6</span><span class="op">)</span>, linOut <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">olden</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marcus W. Beck.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>


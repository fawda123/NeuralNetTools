<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot a neural network model — plotnet • NeuralNetTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot a neural network model — plotnet" />
<meta property="og:description" content="Plot a neural interpretation diagram for a neural network object" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NeuralNetTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/fawda123/NeuralNetTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a neural network model</h1>
    <small class="dont-index">Source: <a href='https://github.com/fawda123/NeuralNetTools/blob/master/R/NeuralNetTools_plot.R'><code>R/NeuralNetTools_plot.R</code></a></small>
    <div class="hidden name"><code>plotnet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Plot a neural interpretation diagram for a neural network object</p>
    </div>

    <pre class="usage"><span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod_in</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod_in</span>, <span class='va'>x_names</span>, <span class='va'>y_names</span>, struct <span class='op'>=</span> <span class='cn'>NULL</span>,
  nid <span class='op'>=</span> <span class='cn'>TRUE</span>, all_out <span class='op'>=</span> <span class='cn'>TRUE</span>, all_in <span class='op'>=</span> <span class='cn'>TRUE</span>, bias <span class='op'>=</span> <span class='cn'>TRUE</span>,
  rel_rsc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>7</span><span class='op'>)</span>, circle_cex <span class='op'>=</span> <span class='fl'>5</span>, node_labs <span class='op'>=</span> <span class='cn'>TRUE</span>, var_labs <span class='op'>=</span> <span class='cn'>TRUE</span>,
  line_stag <span class='op'>=</span> <span class='cn'>NULL</span>, cex_val <span class='op'>=</span> <span class='fl'>1</span>, alpha_val <span class='op'>=</span> <span class='fl'>1</span>,
  circle_col <span class='op'>=</span> <span class='st'>"lightblue"</span>, pos_col <span class='op'>=</span> <span class='st'>"black"</span>, neg_col <span class='op'>=</span> <span class='st'>"grey"</span>,
  bord_col <span class='op'>=</span> <span class='st'>"lightblue"</span>, max_sp <span class='op'>=</span> <span class='cn'>FALSE</span>, pad_x <span class='op'>=</span> <span class='fl'>1</span>, prune_col <span class='op'>=</span> <span class='cn'>NULL</span>,
  prune_lty <span class='op'>=</span> <span class='st'>"dashed"</span>, skip <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for nnet</span>
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod_in</span>, x_names <span class='op'>=</span> <span class='cn'>NULL</span>, y_names <span class='op'>=</span> <span class='cn'>NULL</span>,
  skip <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for numeric</span>
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod_in</span>, <span class='va'>struct</span>, x_names <span class='op'>=</span> <span class='cn'>NULL</span>, y_names <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for mlp</span>
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod_in</span>, x_names <span class='op'>=</span> <span class='cn'>NULL</span>, y_names <span class='op'>=</span> <span class='cn'>NULL</span>,
  prune_col <span class='op'>=</span> <span class='cn'>NULL</span>, prune_lty <span class='op'>=</span> <span class='st'>"dashed"</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for nn</span>
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod_in</span>, x_names <span class='op'>=</span> <span class='cn'>NULL</span>, y_names <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for train</span>
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod_in</span>, x_names <span class='op'>=</span> <span class='cn'>NULL</span>, y_names <span class='op'>=</span> <span class='cn'>NULL</span>,
  skip <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mod_in</th>
      <td><p>neural network object or numeric vector of weights</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed to or from other methods</p></td>
    </tr>
    <tr>
      <th>x_names</th>
      <td><p>chr string indicating names for input variables, default from model object</p></td>
    </tr>
    <tr>
      <th>y_names</th>
      <td><p>chr string indicating names for output variables, default from model object</p></td>
    </tr>
    <tr>
      <th>struct</th>
      <td><p>numeric vector equal in length to the number of layers in the network.  Each number indicates the number of nodes in each layer starting with the input and ending with the output.  An arbitrary number of hidden layers can be included.</p></td>
    </tr>
    <tr>
      <th>nid</th>
      <td><p>logical value indicating if neural interpretation diagram is plotted, default <code>TRUE</code></p></td>
    </tr>
    <tr>
      <th>all_out</th>
      <td><p>chr string indicating names of response variables for which connections are plotted, default all</p></td>
    </tr>
    <tr>
      <th>all_in</th>
      <td><p>chr string indicating names of input variables for which connections are plotted, default all</p></td>
    </tr>
    <tr>
      <th>bias</th>
      <td><p>logical value indicating if bias nodes and connections are plotted, default <code>TRUE</code></p></td>
    </tr>
    <tr>
      <th>rel_rsc</th>
      <td><p>numeric indicating the scaling range for the width of connection weights</p></td>
    </tr>
    <tr>
      <th>circle_cex</th>
      <td><p>numeric value indicating size of nodes, default 5</p></td>
    </tr>
    <tr>
      <th>node_labs</th>
      <td><p>logical value indicating if labels are plotted directly on nodes, default <code>TRUE</code></p></td>
    </tr>
    <tr>
      <th>var_labs</th>
      <td><p>logical value indicating if variable names are plotted next to nodes, default <code>TRUE</code></p></td>
    </tr>
    <tr>
      <th>line_stag</th>
      <td><p>numeric value that specifies distance of connection weights from nodes</p></td>
    </tr>
    <tr>
      <th>cex_val</th>
      <td><p>numeric value indicating size of text labels, default 1</p></td>
    </tr>
    <tr>
      <th>alpha_val</th>
      <td><p>numeric value (0-1) indicating transparency of connections, default 1</p></td>
    </tr>
    <tr>
      <th>circle_col</th>
      <td><p>chr string indicating color of nodes, default <code>'lightblue'</code>, or two element list with first element indicating color of input nodes and second indicating color of remaining nodes</p></td>
    </tr>
    <tr>
      <th>pos_col</th>
      <td><p>chr string indicating color of positive connection weights, default <code>'black'</code></p></td>
    </tr>
    <tr>
      <th>neg_col</th>
      <td><p>chr string indicating color of negative connection weights, default <code>'grey'</code></p></td>
    </tr>
    <tr>
      <th>bord_col</th>
      <td><p>chr string indicating border color around nodes, default <code>'lightblue'</code></p></td>
    </tr>
    <tr>
      <th>max_sp</th>
      <td><p>logical value indicating if space between nodes in each layer is maximized, default <code>FALSE</code></p></td>
    </tr>
    <tr>
      <th>pad_x</th>
      <td><p>numeric for increasing or decreasing padding on the x-axis, values less than one will increase padding and values greater than one will decrease padding</p></td>
    </tr>
    <tr>
      <th>prune_col</th>
      <td><p>chr string indicating color of pruned connections, otherwise not shown</p></td>
    </tr>
    <tr>
      <th>prune_lty</th>
      <td><p>line type for pruned connections, passed to <code><a href='https://rdrr.io/r/graphics/segments.html'>segments</a></code></p></td>
    </tr>
    <tr>
      <th>skip</th>
      <td><p>logical if skip layer connections are plotted instead of the primary network</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A graphics object unless <code>wts_only = TRUE</code>, then neural network weights from <code><a href='neuralweights.html'>neuralweights</a></code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function plots a neural network as a neural interpretation diagram as in Ozesmi and Ozesmi (1999). Options to plot without color-coding or shading of weights are also provided.  The default settings plot positive weights between layers as black lines and negative weights as grey lines. Line thickness is in proportion to relative magnitude of each weight. The first layer includes only input variables with nodes labelled arbitrarily as I1 through In for n input variables.  One through many hidden layers are plotted with each node in each layer labelled as H1 through Hn.  The output layer is plotted last with nodes labeled as O1 through On.  Bias nodes connected to the hidden and output layers are also shown.  Neural networks created using <code><a href='https://rdrr.io/pkg/RSNNS/man/mlp.html'>mlp</a></code> do not show bias layers.</p>
<p>A primary network and a skip layer network can be plotted for <code><a href='https://rdrr.io/pkg/nnet/man/nnet.html'>nnet</a></code> models with a skip layer connection.  The default is to plot the primary network, whereas the skip layer network can be viewed with <code>skip = TRUE</code>.  If <code>nid = TRUE</code>, the line widths for both the primary and skip layer plots are relative to all weights.  Viewing both plots is recommended to see which network has larger relative weights.  Plotting a network with only a skip layer (i.e., no hidden layer, <code>size = 0</code>) will include bias connections to the output layer, whereas these are not included in the plot of the skip layer if <code>size</code> is greater than zero.</p> 
<p>The numeric method for plotting requires the input weights to be in a specific order given the structure of the network.  An additional argument <code>struct</code> (from <code><a href='neuralweights.html'>neuralweights</a></code> is also required that lists the number of nodes in the input, hidden, and output layers.  The example below for the numeric input shows the correct weight vector for a simple neural network model with two input variables, one output variable, and one hidden layer with two nodes.  Bias nodes are also connected to the hidden and output layer.  Using the plot syntax of I, H, O, and B for input, hidden, output, and bias to indicate weighted connections between layers, the correct weight order for the <code>mod_in</code> vector is B1-H1, I1-H1, I2-H1, B1-H2, I1-H2, I2-H2, B2-O1, H1-O1, H2-O1.  For a generic network (three layers) with n input nodes, j hidden nodes, and k output nodes, the weights are ordered as the connections from B1, I1,...,In to H1,...,Hj, then B2, H1,..,Hj to O1,...,Ok.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Beck, M.W. 2018. NeuralNetTools: Visualization and Analysis Tools for Neural Networks. Journal of Statistical Software. 85(11):1-20.</p>
<p>Ozesmi, S.L., Ozesmi, U. 1999. An artificial neural network approach to spatial habitat modeling with interspecific interaction. Ecological Modelling. 116:15-31.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## using numeric input</span>

<span class='co'># B1-H1, I1-H1, I2-H1, B1-H2, I1-H2, I2-H2, B2-O1, H1-O1, H2-O1.</span>
<span class='va'>wts_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>13.12</span>, <span class='fl'>1.49</span>, <span class='fl'>0.16</span>, <span class='op'>-</span><span class='fl'>0.11</span>, <span class='op'>-</span><span class='fl'>0.19</span>, <span class='op'>-</span><span class='fl'>0.16</span>, <span class='fl'>0.56</span>, <span class='op'>-</span><span class='fl'>0.52</span>, <span class='fl'>0.81</span><span class='op'>)</span>
<span class='va'>struct</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>1</span><span class='op'>)</span> <span class='co'>#two inputs, two hidden, one output </span>

<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>wts_in</span>, struct <span class='op'>=</span> <span class='va'>struct</span><span class='op'>)</span>
</div><div class='img'><img src='plotnet-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># numeric input, two hidden layers</span>

<span class='co'># B1-H11, I1-H11, I2-H11, B1-H12, I1-H12, I2-H12, B2-H21, H11-H21, H12-H21, </span>
<span class='co'># B2-H22, H11-H22, H12-H22, B3-O1, H21-O1, H22-O1 </span>
<span class='va'>wts_in</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1.12</span>, <span class='fl'>1.49</span>, <span class='fl'>0.16</span>, <span class='op'>-</span><span class='fl'>0.11</span>, <span class='op'>-</span><span class='fl'>0.19</span>, <span class='op'>-</span><span class='fl'>0.16</span>, <span class='fl'>0.5</span>, <span class='fl'>0.2</span>, <span class='op'>-</span><span class='fl'>0.12</span>, <span class='op'>-</span><span class='fl'>0.1</span>, 
 <span class='fl'>0.89</span>, <span class='fl'>0.9</span>, <span class='fl'>0.56</span>, <span class='op'>-</span><span class='fl'>0.52</span>, <span class='fl'>0.81</span><span class='op'>)</span>
<span class='va'>struct</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>1</span><span class='op'>)</span> <span class='co'># two inputs, two (two nodes each), one output </span>

<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>wts_in</span>, struct <span class='op'>=</span> <span class='va'>struct</span><span class='op'>)</span>
</div><div class='img'><img src='plotnet-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## using nnet</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://www.stats.ox.ac.uk/pub/MASS4/'>nnet</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>neuraldat</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>

<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/nnet/man/nnet.html'>nnet</a></span><span class='op'>(</span><span class='va'>Y1</span> <span class='op'>~</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>X2</span> <span class='op'>+</span> <span class='va'>X3</span>, data <span class='op'>=</span> <span class='va'>neuraldat</span>, size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
</div><div class='output co'>#&gt; # weights:  26
#&gt; initial  value 259.012592 
#&gt; iter  10 value 0.986480
#&gt; iter  20 value 0.225311
#&gt; iter  30 value 0.139585
#&gt; iter  40 value 0.098961
#&gt; iter  50 value 0.038200
#&gt; iter  60 value 0.022839
#&gt; iter  70 value 0.013774
#&gt; iter  80 value 0.008530
#&gt; iter  90 value 0.005172
#&gt; iter 100 value 0.003044
#&gt; final  value 0.003044 
#&gt; stopped after 100 iterations</div><div class='input'> 
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>  
</div><div class='img'><img src='plotnet-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## plot the skip layer from nnet model</span>

<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/nnet/man/nnet.html'>nnet</a></span><span class='op'>(</span><span class='va'>Y1</span> <span class='op'>~</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>X2</span> <span class='op'>+</span> <span class='va'>X3</span>, data <span class='op'>=</span> <span class='va'>neuraldat</span>, size <span class='op'>=</span> <span class='fl'>5</span>, skip <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; # weights:  29
#&gt; initial  value 91.886893 
#&gt; iter  10 value 0.302027
#&gt; iter  20 value 0.028424
#&gt; iter  30 value 0.021294
#&gt; iter  40 value 0.019159
#&gt; iter  50 value 0.017492
#&gt; iter  60 value 0.016319
#&gt; iter  70 value 0.015259
#&gt; iter  80 value 0.013234
#&gt; iter  90 value 0.011249
#&gt; iter 100 value 0.006222
#&gt; final  value 0.006222 
#&gt; stopped after 100 iterations</div><div class='input'>
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod</span>, skip <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>  
</div><div class='img'><img src='plotnet-4.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; NULL</div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'>## using RSNNS, no bias layers</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/cbergmeir/RSNNS'>RSNNS</a></span><span class='op'>)</span>

<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>neuraldat</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'X1'</span>, <span class='st'>'X2'</span>, <span class='st'>'X3'</span><span class='op'>)</span><span class='op'>]</span>
<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>neuraldat</span><span class='op'>[</span>, <span class='st'>'Y1'</span><span class='op'>]</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/RSNNS/man/mlp.html'>mlp</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>

<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>

<span class='co'># pruned model using code from RSSNS pruning demo</span>
<span class='va'>pruneFuncParams</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>max_pr_error_increase <span class='op'>=</span> <span class='fl'>10.0</span>, pr_accepted_error <span class='op'>=</span> <span class='fl'>1.0</span>, 
 no_of_pr_retrain_cycles <span class='op'>=</span> <span class='fl'>1000</span>, min_error_to_stop <span class='op'>=</span> <span class='fl'>0.01</span>, init_matrix_value <span class='op'>=</span> <span class='fl'>1e-6</span>, 
 input_pruning <span class='op'>=</span> <span class='cn'>TRUE</span>, hidden_pruning <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/RSNNS/man/mlp.html'>mlp</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, size <span class='op'>=</span> <span class='fl'>5</span>, pruneFunc <span class='op'>=</span> <span class='st'>"OptimalBrainSurgeon"</span>, 
 pruneFuncParams <span class='op'>=</span> <span class='va'>pruneFuncParams</span><span class='op'>)</span>

<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod</span>, prune_col <span class='op'>=</span> <span class='st'>'lightblue'</span><span class='op'>)</span>

<span class='co'>## using neuralnet</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/bips-hb/neuralnet'>neuralnet</a></span><span class='op'>)</span>

<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/neuralnet/man/neuralnet.html'>neuralnet</a></span><span class='op'>(</span><span class='va'>Y1</span> <span class='op'>~</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>X2</span> <span class='op'>+</span> <span class='va'>X3</span>, data <span class='op'>=</span> <span class='va'>neuraldat</span>, hidden <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>

<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>

<span class='co'>## using caret</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/topepo/caret/'>caret</a></span><span class='op'>)</span>

<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/RSNNS/man/train.html'>train</a></span><span class='op'>(</span><span class='va'>Y1</span> <span class='op'>~</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>X2</span> <span class='op'>+</span> <span class='va'>X3</span>, method <span class='op'>=</span> <span class='st'>'nnet'</span>, data <span class='op'>=</span> <span class='va'>neuraldat</span>, linout <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>

<span class='co'>## a more complicated network with categorical response</span>
<span class='va'>AND</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>7</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>OR</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span>
 
<span class='va'>binary_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>AND</span>, <span class='va'>OR</span><span class='op'>)</span>
 
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/neuralnet/man/neuralnet.html'>neuralnet</a></span><span class='op'>(</span><span class='va'>AND</span> <span class='op'>+</span> <span class='va'>OR</span> <span class='op'>~</span> <span class='va'>Var1</span> <span class='op'>+</span> <span class='va'>Var2</span> <span class='op'>+</span> <span class='va'>Var3</span>, <span class='va'>binary_data</span>, 
 hidden <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>, <span class='fl'>12</span>, <span class='fl'>8</span><span class='op'>)</span>, rep <span class='op'>=</span> <span class='fl'>10</span>, err.fct <span class='op'>=</span> <span class='st'>'ce'</span>, linear.output <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
 
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>

<span class='co'>## recreate the previous example with numeric inputs</span>

<span class='co'># get the weights and structure in the right format</span>
<span class='va'>wts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='neuralweights.html'>neuralweights</a></span><span class='op'>(</span><span class='va'>mod</span><span class='op'>)</span>
<span class='va'>struct</span> <span class='op'>&lt;-</span> <span class='va'>wts</span><span class='op'>$</span><span class='va'>struct</span>
<span class='va'>wts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>wts</span><span class='op'>$</span><span class='va'>wts</span><span class='op'>)</span>

<span class='co'># plot</span>
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>wts</span>, struct <span class='op'>=</span> <span class='va'>struct</span><span class='op'>)</span>

<span class='co'>## color input nodes by relative importance</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/nnet/man/nnet.html'>nnet</a></span><span class='op'>(</span><span class='va'>Y1</span> <span class='op'>~</span> <span class='va'>X1</span> <span class='op'>+</span> <span class='va'>X2</span> <span class='op'>+</span> <span class='va'>X3</span>, data <span class='op'>=</span> <span class='va'>neuraldat</span>, size <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>
 
<span class='va'>rel_imp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='garson.html'>garson</a></span><span class='op'>(</span><span class='va'>mod</span>, bar_plot <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>$</span><span class='va'>rel_imp</span>
<span class='va'>cols</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'lightgreen'</span>, <span class='st'>'darkgreen'</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/rank.html'>rank</a></span><span class='op'>(</span><span class='va'>rel_imp</span><span class='op'>)</span><span class='op'>]</span>
 
<span class='fu'>plotnet</span><span class='op'>(</span><span class='va'>mod</span>, circle_col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>cols</span>, <span class='st'>'lightblue'</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Marcus W. Beck.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


